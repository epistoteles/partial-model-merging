-------------------SBATCH STATS-------------------
Total CPU cores:      6
Visible CPU cores:    3
Visible GPUs:         NVIDIA GeForce GTX 1060 6GB
--------------------------------------------------
Evaluating MNIST-MLP3-1.0x-a, MNIST-MLP3-1.0x-b
steps: 21; expansions: [1.1, 1.2, 1.5]
Collecting ensembling metrics ...
Collecting naive merging metrics ...
Interpolating and evaluating model
  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:01<00:38,  1.91s/it] 10%|▉         | 2/21 [00:03<00:35,  1.87s/it] 14%|█▍        | 3/21 [00:05<00:33,  1.89s/it] 19%|█▉        | 4/21 [00:07<00:32,  1.88s/it] 24%|██▍       | 5/21 [00:09<00:29,  1.87s/it] 29%|██▊       | 6/21 [00:11<00:27,  1.86s/it] 33%|███▎      | 7/21 [00:13<00:26,  1.86s/it] 38%|███▊      | 8/21 [00:14<00:24,  1.87s/it] 43%|████▎     | 9/21 [00:16<00:22,  1.89s/it] 48%|████▊     | 10/21 [00:18<00:20,  1.88s/it] 52%|█████▏    | 11/21 [00:20<00:18,  1.88s/it] 57%|█████▋    | 12/21 [00:22<00:16,  1.88s/it] 62%|██████▏   | 13/21 [00:24<00:15,  1.89s/it] 67%|██████▋   | 14/21 [00:26<00:13,  1.87s/it] 71%|███████▏  | 15/21 [00:28<00:11,  1.86s/it] 76%|███████▌  | 16/21 [00:29<00:09,  1.87s/it] 81%|████████  | 17/21 [00:31<00:07,  1.88s/it] 86%|████████▌ | 18/21 [00:33<00:05,  1.88s/it] 90%|█████████ | 19/21 [00:35<00:03,  1.87s/it] 95%|█████████▌| 20/21 [00:37<00:01,  1.86s/it]100%|██████████| 21/21 [00:39<00:00,  1.88s/it]100%|██████████| 21/21 [00:39<00:00,  1.88s/it]
Interpolating and evaluating model
  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:00<00:08,  2.24it/s] 10%|▉         | 2/21 [00:00<00:08,  2.25it/s] 14%|█▍        | 3/21 [00:01<00:08,  2.21it/s] 19%|█▉        | 4/21 [00:01<00:07,  2.26it/s] 24%|██▍       | 5/21 [00:02<00:07,  2.19it/s] 29%|██▊       | 6/21 [00:02<00:06,  2.22it/s] 33%|███▎      | 7/21 [00:03<00:06,  2.21it/s] 38%|███▊      | 8/21 [00:03<00:05,  2.21it/s] 43%|████▎     | 9/21 [00:04<00:05,  2.22it/s] 48%|████▊     | 10/21 [00:04<00:04,  2.23it/s] 52%|█████▏    | 11/21 [00:04<00:04,  2.25it/s] 57%|█████▋    | 12/21 [00:05<00:04,  2.21it/s] 62%|██████▏   | 13/21 [00:05<00:03,  2.23it/s] 67%|██████▋   | 14/21 [00:06<00:03,  2.22it/s] 71%|███████▏  | 15/21 [00:06<00:02,  2.23it/s] 76%|███████▌  | 16/21 [00:07<00:02,  2.24it/s] 81%|████████  | 17/21 [00:07<00:01,  2.25it/s] 86%|████████▌ | 18/21 [00:08<00:01,  2.22it/s] 90%|█████████ | 19/21 [00:08<00:00,  2.24it/s] 95%|█████████▌| 20/21 [00:08<00:00,  2.23it/s]100%|██████████| 21/21 [00:09<00:00,  2.24it/s]100%|██████████| 21/21 [00:09<00:00,  2.23it/s]
Collecting permuted merging metrics ...
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:14,  4.17it/s]  7%|▋         | 4/60 [00:00<00:04, 12.79it/s] 12%|█▏        | 7/60 [00:00<00:03, 16.23it/s] 17%|█▋        | 10/60 [00:00<00:02, 18.06it/s] 22%|██▏       | 13/60 [00:00<00:02, 19.17it/s] 27%|██▋       | 16/60 [00:00<00:02, 19.87it/s] 32%|███▏      | 19/60 [00:01<00:02, 20.30it/s] 37%|███▋      | 22/60 [00:01<00:01, 20.59it/s] 42%|████▏     | 25/60 [00:01<00:01, 20.87it/s] 47%|████▋     | 28/60 [00:01<00:01, 21.09it/s] 52%|█████▏    | 31/60 [00:01<00:01, 21.22it/s] 57%|█████▋    | 34/60 [00:01<00:01, 21.25it/s] 62%|██████▏   | 37/60 [00:01<00:01, 21.29it/s] 67%|██████▋   | 40/60 [00:02<00:00, 21.32it/s] 72%|███████▏  | 43/60 [00:02<00:00, 21.35it/s] 77%|███████▋  | 46/60 [00:02<00:00, 21.40it/s] 82%|████████▏ | 49/60 [00:02<00:00, 21.43it/s] 87%|████████▋ | 52/60 [00:02<00:00, 21.42it/s] 92%|█████████▏| 55/60 [00:02<00:00, 21.34it/s] 97%|█████████▋| 58/60 [00:02<00:00, 21.02it/s]100%|██████████| 60/60 [00:03<00:00, 19.63it/s]
Saving corrs of layer 1 to /home/korbinian/Documents/partial-model-merging/evaluations/correlations/MNIST-MLP3-1.0x-ab.safetensors
Candidates: 0.00767259994910452
Selected: 0.5714577368426839
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:14,  4.10it/s]  7%|▋         | 4/60 [00:00<00:04, 13.18it/s] 12%|█▏        | 7/60 [00:00<00:03, 16.59it/s] 17%|█▋        | 10/60 [00:00<00:02, 18.36it/s] 22%|██▏       | 13/60 [00:00<00:02, 19.42it/s] 27%|██▋       | 16/60 [00:00<00:02, 20.09it/s] 32%|███▏      | 19/60 [00:01<00:02, 20.49it/s] 37%|███▋      | 22/60 [00:01<00:01, 20.79it/s] 42%|████▏     | 25/60 [00:01<00:01, 20.60it/s] 47%|████▋     | 28/60 [00:01<00:01, 20.77it/s] 52%|█████▏    | 31/60 [00:01<00:01, 20.58it/s] 57%|█████▋    | 34/60 [00:01<00:01, 20.96it/s] 62%|██████▏   | 37/60 [00:01<00:01, 20.93it/s] 67%|██████▋   | 40/60 [00:02<00:00, 20.77it/s] 72%|███████▏  | 43/60 [00:02<00:00, 21.17it/s] 77%|███████▋  | 46/60 [00:02<00:00, 21.22it/s] 82%|████████▏ | 49/60 [00:02<00:00, 21.11it/s] 87%|████████▋ | 52/60 [00:02<00:00, 20.87it/s] 92%|█████████▏| 55/60 [00:02<00:00, 21.06it/s] 97%|█████████▋| 58/60 [00:02<00:00, 21.45it/s]100%|██████████| 60/60 [00:03<00:00, 19.43it/s]
Saving corrs of layer 2 to /home/korbinian/Documents/partial-model-merging/evaluations/correlations/MNIST-MLP3-1.0x-ab.safetensors
Candidates: 0.021835505063055594
Selected: 0.6372491632668802
Interpolating and evaluating model
  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:01<00:37,  1.89s/it] 10%|▉         | 2/21 [00:03<00:35,  1.88s/it] 14%|█▍        | 3/21 [00:05<00:33,  1.88s/it] 19%|█▉        | 4/21 [00:07<00:31,  1.88s/it] 24%|██▍       | 5/21 [00:09<00:29,  1.86s/it] 29%|██▊       | 6/21 [00:11<00:27,  1.86s/it] 33%|███▎      | 7/21 [00:13<00:26,  1.87s/it] 38%|███▊      | 8/21 [00:14<00:24,  1.86s/it] 43%|████▎     | 9/21 [00:16<00:22,  1.87s/it] 48%|████▊     | 10/21 [00:18<00:20,  1.87s/it] 52%|█████▏    | 11/21 [00:20<00:18,  1.86s/it] 57%|█████▋    | 12/21 [00:22<00:16,  1.86s/it] 62%|██████▏   | 13/21 [00:24<00:14,  1.87s/it] 67%|██████▋   | 14/21 [00:26<00:13,  1.88s/it] 71%|███████▏  | 15/21 [00:28<00:11,  1.88s/it] 76%|███████▌  | 16/21 [00:29<00:09,  1.88s/it] 81%|████████  | 17/21 [00:31<00:07,  1.88s/it] 86%|████████▌ | 18/21 [00:33<00:05,  1.86s/it] 90%|█████████ | 19/21 [00:35<00:03,  1.86s/it] 95%|█████████▌| 20/21 [00:37<00:01,  1.87s/it]100%|██████████| 21/21 [00:39<00:00,  1.87s/it]100%|██████████| 21/21 [00:39<00:00,  1.87s/it]
Interpolating and evaluating model
  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:00<00:09,  2.19it/s] 10%|▉         | 2/21 [00:00<00:08,  2.26it/s] 14%|█▍        | 3/21 [00:01<00:07,  2.26it/s] 19%|█▉        | 4/21 [00:01<00:07,  2.23it/s] 24%|██▍       | 5/21 [00:02<00:07,  2.21it/s] 29%|██▊       | 6/21 [00:02<00:06,  2.22it/s] 33%|███▎      | 7/21 [00:03<00:06,  2.23it/s] 38%|███▊      | 8/21 [00:03<00:05,  2.24it/s] 43%|████▎     | 9/21 [00:04<00:05,  2.25it/s] 48%|████▊     | 10/21 [00:04<00:04,  2.21it/s] 52%|█████▏    | 11/21 [00:04<00:04,  2.20it/s] 57%|█████▋    | 12/21 [00:05<00:04,  2.20it/s] 62%|██████▏   | 13/21 [00:05<00:03,  2.20it/s] 67%|██████▋   | 14/21 [00:06<00:03,  2.21it/s] 71%|███████▏  | 15/21 [00:06<00:02,  2.20it/s] 76%|███████▌  | 16/21 [00:07<00:02,  2.23it/s] 81%|████████  | 17/21 [00:07<00:01,  2.25it/s] 86%|████████▌ | 18/21 [00:08<00:01,  2.26it/s] 90%|█████████ | 19/21 [00:08<00:00,  2.21it/s] 95%|█████████▌| 20/21 [00:08<00:00,  2.24it/s]100%|██████████| 21/21 [00:09<00:00,  2.25it/s]100%|██████████| 21/21 [00:09<00:00,  2.23it/s]
Collecting permuted merging + REPAIR metrics ...
Interpolating, REPAIRing, and evaluating model
  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/korbinian/Documents/partial-model-merging/eval_mlps.py", line 8, in <module>
    evaluate_two_models(model_name, expansions=[1.1, 1.2, 1.5])
  File "/home/korbinian/Documents/partial-model-merging/venv/lib/python3.10/site-packages/codecarbon/emissions_tracker.py", line 791, in wrapped_fn
    fn_result = fn(*args, **kwargs)
  File "/home/korbinian/Documents/partial-model-merging/src/evaluate.py", line 189, in evaluate_two_models
    ) = evaluate_two_models_merging_REPAIR(
  File "/home/korbinian/Documents/partial-model-merging/src/evaluate.py", line 316, in evaluate_two_models_merging_REPAIR
    model_repaired = partial_repair(model_merged, model_a, model_b, repair_loader, alpha)
  File "/home/korbinian/Documents/partial-model-merging/src/utils.py", line 1173, in partial_repair
    tracked_model_a = make_tracked_model(parent_model_a)
  File "/home/korbinian/Documents/partial-model-merging/src/utils.py", line 1036, in make_tracked_model
    feats = tracked_model.features
  File "/home/korbinian/Documents/partial-model-merging/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLP' object has no attribute 'features'
